<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="soundboard.css" />
    <title>Soundboard</title>
    <meta
      http-equiv="Content-Security-Policy"
      content="worker-src 'self'; media-src *"
    />
    <meta charset="UTF-8" />
  </head>

  <body>
    <h1>Jitsi Bot</h1>
    <label for="targetJitsi">Conference URL: </label>
    <input style="width: 20vw" type="url" id="targetJitsi" />
    <br />
    <button id="start_bot_button">Start Bot.</button>
    <br />
    <h3>Soundboard Control</h3>
    <audio
      src="../audio/nggyu.mp3"
      controls
      id="soundboard"
      crossorigin="anonymous"
    ></audio>
    <video
      id="videoboard"
      crossorigin="anonymous"
      controls
      src="../video/oops.webm"
    ></video>
    <br />
    <form id="soundboardInputForm">
      <label for="soundboardSourceInput">Audio Source Input</label>
      <input
        type="url"
        name="soundboardSourceInput"
        id="soundboardSourceInput"
        pattern=".*\/\/.*\.(mp3|m4a)"
        autocomplete="section-soundboard url"
        style="width: 30%"
      />
      <button type="submit" id="setSoundboardSource">Set Source</button>
    </form>

    <section id="localSoundsSection">
      <h3>Local Sounds</h3>
      <div id="localSoundButtons" class="sound-buttons"></div>
    </section>

    <br />
    <div class="wrapper">
      <section id="logOuter">
        <h3>Jitsi Bot Log</h3>
        <button id="clearLog">Clear Log</button>
        <p></p>
        <div id="log" style="white-space: pre-wrap"></div>
      </section>
      <aside id="participantsOuter">
        <h3>Participants</h3>
        <div id="participantsInner"></div>
      </aside>
    </div>
  </body>
  <script id="libJitsiMeet"></script>
  <script id="jitsiConfig"></script>
  <script src="../jitsi-bot/defaults.js"></script>
  <script src="soundboard.js"></script>
  <script src="../jitsi-bot/pageParams.js"></script>
  <script id="confInit"></script>
  <script>
    const localAudioFiles = [
      'birds',
      'bonfire',
      'fireplace',
      'forest',
      'gong',
      'meeresrauschen',
      'natur',
      'nggyu',
      'ocean',
      'rain',
      'rainforest',
      'tagesschau',
    ]

    function makeSoundButton(label, src) {
      const btn = document.createElement('button')
      btn.textContent = label
      btn.classList.add('sound-btn')
      btn.addEventListener('click', () => {
        soundboard.src = src
        soundboard.play()
      })
      return btn
    }

    // Local audio buttons
    const localContainer = document.querySelector('#localSoundButtons')
    localAudioFiles.forEach((name) => {
      localContainer.appendChild(makeSoundButton(name, `../audio/${name}.mp3`))
    })
  </script>
</html>
